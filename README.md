# Piano-Sound-Recognition-Technology
<h1>基于Matlab的钢琴乐音识别技术研究</h1>

<h2>技术路线：</h2>

![image](https://github.com/YOKOKAO/Piano-Sound-Recognition-Technology/assets/106002987/8b2d41d7-4d2e-4ae3-9293-56dee181ea18)

<h2>实现步骤：</h2>

（1）使用audioread函数读入音频文件，取音频文件单声道，并做归一化处理。给出音频信号的横坐标。

（2）对音频信号进行分帧，记录每一帧内的峰峰值，记录在包络数组中。使用hold on功能在音频图上绘制包络线，其中包络线的横坐标与音频信号不同，其间隔为帧长。

（3）对包络线依次进行11点均值滤波、11点中值滤波、21点均值滤波。做归一化处理。

（4）使用findpeaks函数寻找包络峰值点，设定幅度限制为0.35，并设定最小峰间隔。

（5）由于音乐信号的功率谱会随频率的增加而减小，大部分能量集中在低频范围，中高频部分能量较小，为了尽量避免该现象导致基频提取错误，加入预加重的步骤，使音频信号通过一个高通滤波器，滤波器的系数为b=[1,-0.9375], a=1。

（6）取每一音程段前2/3长度的点，乘以相同点数的窗函数汉宁窗，以缓解频谱泄露现象。

（7）对每段音程做FFT谱分析，画出整个音频的短时傅里叶谱图，对比不同帧长下谱泄露情况，选择按照音程画短时傅里叶谱图。

（8）使用xlsread函数读入钢琴按键与频率对应表，存入Piano_Key_F数组。

（9）将音频幅度矩阵映射到按键矩阵中，其中按键矩阵对应音频幅度矩阵取对应按键频率/频谱观察分辨率为索引值时的值。对按键矩阵进行归一化处理。绘制按键矩阵图及瀑布图。

（10）观察按键矩阵，与标准曲谱对比，建立识别策略。设定识别阈值为0.6。观察发现谱图中常常出现基频的二次谐波分量，因此通过二次谐波帮助识别基频，其中二次谐波的键号比基频键号大12。

（11）显示识别结果，显示每个音程的键号以及瀑布图。对结果进行反思，进一步优化参数与识别策略。

（12）音频节奏评价，取实际节拍为音程段时间*BPM/60，与标准节拍进行比较，计算节拍误差值，并绘制可视化节奏评价图。当实际节拍小于标准节拍时说明节奏快了，大于标准节拍时说明节奏慢了。
